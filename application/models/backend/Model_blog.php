<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');class Model_blog extends CI_Model {    function __construct()    {        parent::__construct();    }            function getModule($module_name){            $data = array();                        $sql="select module_id , module_group_id from tbl_module where module_name='".$module_name."' ";         		 $hasil = $this->db->query($sql);                        if($hasil->num_rows() > 0){				$data = $hasil->result();			}                        else{                            $data = '';                        }			$hasil->free_result();                        $this->db->close();			return $data;                 }            function getListBlog($cond = null){		$query		= "SELECT a.blog_id, a.blog_title, a.blog_backlink, "                                    . "  a.blog_desc, a.blog_order, a.blog_active_status,a.blog_alias,"                                    . " a.blog_meta_description, a.blog_meta_keywords, "                                    . " DATE_FORMAT( a.blog_create_date, '%d-%m-%Y %H:%i:%s' ) as blog_create_date,"                                    . " a.blog_create_by "                                      . "FROM tbl_blog as a "                                    . " ".$cond;		$query		= $this->db->query($query)->result_array();				return $query;	}		function getListBlogAlias(){		$query		= "SELECT blog_id, blog_title, blog_backlink,  blog_desc, blog_meta_description, blog_meta_keywords,						DATE_FORMAT( blog_create_date, '%d %M %Y' ) as blog_create_date,						c.web_alias, c.web_ori						FROM tbl_blog a						INNER JOIN tbl_alias c ON a.blog_id = c.key_id 						WHERE a.blog_active_status = 1 AND c.alias_category = 'blog' AND c.alias_active_status = 1						ORDER BY blog_id DESC";		$query		= $this->db->query($query)->result_array();				return $query;	}		function getBlog($id = '')	{		$where = '';		if($id != ''){			$where = "WHERE blog_id = ".$id;		}		  $sql	= "SELECT a.blog_id,  a.blog_title, a.blog_backlink,"                                    . "  a.blog_desc, a.blog_active_status, a.blog_alias, "                                    . " a.blog_meta_description, a.blog_meta_keywords, "                                    . " DATE_FORMAT( a.blog_create_date, '%d-%m-%Y %H:%i:%s' ) as blog_create_date,"                                    . " a.blog_create_by"                                    . " FROM tbl_blog as a "                                    . " $where "                                    . " ORDER BY blog_id ASC";			$query	= $this->db->query($sql);		$rs		= $query->result_array(); 				return $rs;		}		function activeBlog($id)	{		$sql	= "UPDATE tbl_blog SET blog_active_status = abs(blog_active_status-1),  				   blog_update_date = now(), 				   blog_update_by = ".$_SESSION['admin_data']['user_id']."				   WHERE blog_id = ".$id;			$query	= $this->db->query($sql);				return $query;	}		function deleteBlog($id = '')	{		$sql	= "DELETE FROM tbl_blog WHERE blog_id = ".$id;			$query	= $this->db->query($sql);				$str = $this->db->last_query();				return $str;	}		function checkBlog($blog_title){		$sql	= "SELECT blog_title FROM tbl_blog WHERE blog_title = '".$blog_title."'";		$query	= $this->db->query($sql);		$rs		= $query->result_array(); 		return $rs;	}		function insertBlog($blog_title,$blog_desc,$alias,$blog_metadescription,$blog_metakeywords,$blog_backlink)	{		$sql	= "INSERT INTO tbl_blog SET                            blog_title='".$blog_title."',                             blog_alias ='".$alias."',                             blog_backlink='".$blog_backlink."',                             blog_meta_description='".$blog_metadescription."',                             blog_meta_keywords='".$blog_metakeywords."',                             blog_active_status = 0,                              blog_desc='".$blog_desc."',                            blog_create_by = ".$_SESSION['admin_data']['user_id'].", blog_create_date = now()";					$query  = $this->db->query($sql);		$last_id  = $this->db->insert_id();				return $last_id;	}        function setOrderBlog ($count, $last_id){            $sql	= "UPDATE tbl_blog as a SET                               a.blog_order ='$count',                             a.blog_update_by = ".$_SESSION['admin_data']['user_id'].",                             a.blog_update_date=now() WHERE a.blog_id = ".$last_id;	            $query	= $this->db->query($sql);        }        function getCountBlog() {            $data = array();             $hasil =  $this->db->query("select Count(blog_id) as jumlah from tbl_blog");				$data = $hasil->row_array();                                               return $data['jumlah'];                     }        	function updateBlog($id,$blog_title,$blog_desc,$alias,$blog_metadescription,$blog_metakeywords,$blog_backlink)	{		$sql	= "UPDATE tbl_blog SET                             blog_title='".$blog_title."',                              blog_alias ='".$alias."',                             blog_desc='".$blog_desc."',                             blog_backlink='".$blog_backlink."',                            blog_meta_description='".$blog_metadescription."',                             blog_meta_keywords='".$blog_metakeywords."',                             blog_update_by = ".$_SESSION['admin_data']['user_id'].",                             blog_update_date=now() WHERE blog_id = ".$id;			$query	= $this->db->query($sql);				return $query;	}         function updateOrderBlog($id,$order)	{		$sql	= "UPDATE tbl_blog SET 				   blog_order= ".$order.",				   blog_update_by = ".$_SESSION['admin_data']['user_id'].", blog_update_date=now() WHERE blog_id = ".$id;			$query	= $this->db->query($sql);				return $query;	}              function generateBlog($cond = null){		 $query		= "SELECT a.blog_id,a.blog_title, a.blog_backlink,"                                    . "  a.blog_desc, a.blog_order, a.blog_active_status, a.blog_alias,"                                    . " a.blog_meta_description, a.blog_meta_keywords, "                                    . "DATE_FORMAT( a.blog_publish_date, '%d-%m-%Y %H:%i:%s' ) as blog_publish_date, a.blog_create_by "                                                                       . "FROM tbl_blog as a "                                                                       . " ".$cond;		$query		= $this->db->query($query)->result_array();				return $query;	}                   function insertCategory($category_title)	{		$sql	= "INSERT INTO tbl_blog_category SET  category_title='".$category_title."' ";				$query  = $this->db->query($sql);		$last_id  = $this->db->insert_id();				return $last_id;	}                 function getBlogCategory(){         $data = array();         $sql="select * from tbl_blog_category order by category_id asc";                  $hasil = $this->db->query($sql);                        if($hasil->num_rows() > 0){				$data = $hasil->result();			}                        else{                            $data = '';                        }			$hasil->free_result();                        $this->db->close();			return $data;              }                   }