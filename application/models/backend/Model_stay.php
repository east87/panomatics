<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');class Model_stay extends CI_Model {    function __construct()    {        parent::__construct();    }        function getModule($module_name){            $data = array();            $sql="select module_id , module_group_id from tbl_module where module_path='".$module_name."' ";         		 $hasil = $this->db->query($sql);                        if($hasil->num_rows() > 0){				$data = $hasil->result();			}                        else{                            $data = '';                        }			$hasil->free_result();                        $this->db->close();			return $data;                 }         function getListStay($cond = null){		  $query	    = "SELECT  a.stay_id,  a.stay_title, a.stay_image, a.stay_order, a.stay_desc,"                                    . "  a.stay_active_status,"                                    . "DATE_FORMAT( a.stay_create_date, '%d-%m-%Y %H:%i:%s' ) as stay_create_date, a.stay_create_by "                                                                      . "FROM tbl_stay as a "                                    . " ".$cond;		$query		= $this->db->query($query)->result_array();		return $query;	}         		function getListStayAlias(){		 $query		= "SELECT stay_id, stay_title, stay_image, stay_desc,						DATE_FORMAT( stay_create_date, '%d %M %Y' ) as stay_create_date,						c.web_alias, c.web_ori						FROM tbl_stay a						INNER JOIN tbl_alias c ON a.stay_id = c.key_id 						WHERE a.stay_active_status = 1 AND c.alias_category = 'stay' AND c.alias_active_status = 1						ORDER BY stay_id DESC";		$query		= $this->db->query($query)->result_array();		return $query;	}		function getStay($id = '')	{		$where = '';		if($id != ''){			$where = "WHERE stay_id = ".$id;		}		 $sql	= "SELECT a.stay_id,a.stay_title,a.stay_image,a.stay_order, a.stay_active_status,a.stay_desc,a.stay_desc2,a.stay_urla,a.stay_urlb,a.stay_urlc,a.stay_urld, "                                    . "DATE_FORMAT( a.stay_create_date, '%d-%m-%Y %H:%i:%s' ) as stay_create_date, a.stay_create_by "                                                                      . "FROM tbl_stay as a "                                    . " $where "                                    . " ORDER BY stay_id ASC";			$query	= $this->db->query($sql);		$rs		= $query->result_array(); 		return $rs;		}	function checkStay($stay_title){		$sql	= "SELECT stay_title FROM tbl_stay WHERE stay_title = '".$stay_title."'";		$query	= $this->db->query($sql);		$rs		= $query->result_array(); 		return $rs;	}	function activeStay($id)	{		$sql	= "UPDATE tbl_stay SET stay_active_status = abs(stay_active_status-1),  				   stay_update_date = now(), 				   stay_update_by = ".$_SESSION['admin_data']['user_id']."				   WHERE stay_id = ".$id;			$query	= $this->db->query($sql);				return $query;	}	function deleteStay($id = '')	{		$sql	= "DELETE FROM tbl_stay WHERE stay_id = ".$id;			$query	= $this->db->query($sql);				$str = $this->db->last_query();				return $str;	}        function insertStay($stay_title,$stay_imageurl,$stay_desc,$stay_desc2,$stay_urla,$stay_urlb,$stay_urlc,$stay_urld)	{		$sql	= "INSERT INTO tbl_stay SET                             stay_title='".$stay_title."',                            stay_image='".$stay_imageurl."',                            stay_desc='".$stay_desc."',                            stay_desc2='".$stay_desc2."',                            stay_urla='".$stay_urla."',                            stay_urlb='".$stay_urlb."',                            stay_urlc='".$stay_urlc."',                            stay_urld='".$stay_urld."',                            stay_create_by = ".$_SESSION['admin_data']['user_id'].", stay_create_date = now()";					$query  = $this->db->query($sql);		$last_id  = $this->db->insert_id();		return $last_id;	}	function updateStay($id,$stay_title,$stay_imageurl,$stay_desc,$stay_desc2,$stay_urla,$stay_urlb,$stay_urlc,$stay_urld)	{		 $sql	= "UPDATE tbl_stay SET                             stay_title='".$stay_title."',                             stay_image='".$stay_imageurl."',                            stay_desc='".$stay_desc."',                            stay_desc2='".$stay_desc2."',                            stay_urla='".$stay_urla."',                            stay_urlb='".$stay_urlb."',                            stay_urlc='".$stay_urlc."',                            stay_urld='".$stay_urld."',                            stay_update_by = ".$_SESSION['admin_data']['user_id'].",                             stay_update_date=now() WHERE stay_id = ".$id;			$query	= $this->db->query($sql);		return $query;	}         function updateOrderStay($id,$order)	{		$sql	= "UPDATE tbl_stay SET 				   stay_order= ".$order.",				   stay_update_by = ".$_SESSION['admin_data']['user_id'].", stay_update_date=now() WHERE stay_id = ".$id;			$query	= $this->db->query($sql);				return $query;	}         function getPageView(){         $data = array();         $sql="select * from tbl_page_view order by page_type asc";                  $hasil = $this->db->query($sql);                        if($hasil->num_rows() > 0){				$data = $hasil->result();			}                        else{                            $data = '';                        }			$hasil->free_result();                        $this->db->close();			return $data;              }           function generateStay($cond = null){		 $query		= "SELECT a.stay_id,a.stay_title,a.stay_image, a.stay_order,a.stay_desc,a.stay_desc2,a.stay_urla,a.stay_urlb,a.stay_urlc,a.stay_urld, "                                    . "DATE_FORMAT( a.stay_create_date, '%d-%m-%Y %H:%i:%s' ) as stay_create_date, a.stay_create_by "                                                                      . "FROM tbl_stay as a "                                    . " ".$cond;		$query		= $this->db->query($query)->result_array();				return $query;	}   }