<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');class Model_subscribe extends CI_Model {    function __construct()    {        parent::__construct();    }            function getModule($module_name){            $data = array();            $sql="select module_id , module_group_id from tbl_module where module_name='".$module_name."' ";         		 $hasil = $this->db->query($sql);                        if($hasil->num_rows() > 0){				$data = $hasil->result();			}                        else{                            $data = '';                        }			$hasil->free_result();                        $this->db->close();			return $data;                 }            function getListSubscribe($cond = null){		$query		= "SELECT a.subscribe_id,  a.subscribe_email,a.subscribe_verification_code,a.subscribe_active_status, "                                    . "DATE_FORMAT( a.subscribe_date, '%d-%m-%Y %H:%i:%s' ) as subscribe_date "                                    . "FROM tbl_subscribe as a "                                    . " ".$cond;		$query		= $this->db->query($query)->result_array();				return $query;	}				function getSubscribe($id = '')	{		$where = '';		if($id != ''){			$where = "WHERE subscribe_id = ".$id;		}		$sql	= "SELECT a.subscribe_id,  a.subscribe_email,a.subscribe_active_status,"                                    . "DATE_FORMAT( a.subscribe_date, '%d-%m-%Y %H:%i:%s' ) as subscribe_date "                                    . "FROM tbl_subscribe as a "                                    . " $where "                                    . " ORDER BY subscribe_id ASC";			$query	= $this->db->query($sql);		$rs		= $query->result_array(); 			return $rs;		}		function activeSubscribe($id)	{		$sql	= "UPDATE tbl_subscribe SET subscribe_active_status = abs(subscribe_active_status-1)				   WHERE subscribe_id = ".$id;			$query	= $this->db->query($sql);				return $query;	}		function deleteSubscribe($id = '')	{		$sql	= "DELETE FROM tbl_subscribe WHERE subscribe_id = ".$id;			$query	= $this->db->query($sql);				$str = $this->db->last_query();				return $str;	}		function checkSubscribe($subscribe_email){		$sql	= "SELECT subscribe_email FROM tbl_subscribe WHERE subscribe_email = '".$subscribe_email."'";		$query	= $this->db->query($sql);		$rs		= $query->result_array(); 		return $rs;	}		function insertSubscribe($subscribe_email,$verification_code)	{		$sql	= "INSERT INTO tbl_subscribe SET "                        . " subscribe_email='".$subscribe_email."',"                        . " subscribe_verification_code='".$verification_code."',"                        . "  subscribe_date = now()";	                $query  = $this->db->query($sql);		$last_id  = $this->db->insert_id();		return $last_id;	}		function updateSubscribe($id,$subscribe_email)	{		$sql	= "UPDATE tbl_subscribe SET                             subscribe_email='".$subscribe_email."' "                        . " WHERE subscribe_id = ".$id;			$query	= $this->db->query($sql);				return $query;	}        function getVerification($verification_code = '')	{                   $where = '';		if($verification_code != ''){			$where = "WHERE subscribe_verification_code = '".$verification_code."' ";		}		 $sql	= "SELECT a.subscribe_id,  a.subscribe_email,a.subscribe_active_status,a.subscribe_verification_code,"                                    . "DATE_FORMAT( a.subscribe_date, '%d-%m-%Y %H:%i:%s' ) as subscribe_date "                                    . "FROM tbl_subscribe as a "                                    . " $where "                                    . " ORDER BY subscribe_id ASC";			$query	= $this->db->query($sql);		$rs		= $query->result_array(); 			return $rs;		}                  function noActive($verification_code){            $sql	= "UPDATE tbl_subscribe SET                             subscribe_active_status=0 "                        . " WHERE subscribe_verification_code='".$verification_code."' ";			$query	= $this->db->query($sql);				return $query;        }    function active($verification_code){            $sql	= "UPDATE tbl_subscribe SET                             subscribe_active_status=1 "                        . " WHERE subscribe_verification_code='".$verification_code."' ";			$query	= $this->db->query($sql);				return $query;        }}